<!-- Calculator Container -->

<div style="padding: 40px 16px">
    <h1 style="font-size:28px">เครื่องมือคำนวณราคา DR</h1>
    <hr>
    <div style="background: #ffffff; border: 1px solid #e6e8ed; border-radius: 32px; display: flex !important; flex-direction: row !important; gap: 0; width: 100%; max-width: 100%; overflow: hidden;"
        data-node-id="16801:73266">
        <!-- Left Panel: Input Form -->
        <div style="flex: 1; padding: 40px; display: flex; flex-direction: column; gap: 32px;"
            data-node-id="16801:73267">
            <!-- Header with DR Code -->
            <div
                style="border-bottom: 1px solid #cbd3df; padding-bottom: 8px; display: flex; gap: 8px; align-items: center;">
                <div style="position: relative; flex: 1; display: flex; align-items: center; gap: 12px;">
                    <input type="text" id="calculator-dr-code" value="NDX01" placeholder="พิมพ์ DR code..."
                        style="font-family: 'BLS', sans-serif; font-size: 32px; font-weight: 800; line-height: 1.2; color: #1e90ff; border: none; outline: none; background: transparent; padding: 0; margin: 0; flex: 1; min-width: 0;">
                    <img src="/getmedia/c1df46f2-c394-4bde-a851-05a8ff7ce33c/search-1.webp" alt="search"
                        style="width: 28px; height: 28px; flex-shrink: 0; cursor: pointer;"
                        class="calculator-search-icon">

                    <!-- Dropdown List -->
                    <ul id="dropdownList"
                        style="display: none; position: absolute; top: calc(100% + 8px); left: 0; right: 0; background: white; border: 1px solid #cbd3df; border-radius: 8px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15); z-index: 1000; list-style: none; margin: 0; padding: 0; max-height: 250px; overflow-y: auto;">
                        <!-- Items populated by JavaScript -->
                    </ul>
                </div>
            </div>

            <!-- ETF Name -->
            <p id="calculator-etf-name"
                style="font-family: 'BLS', sans-serif; font-size: 18px; font-weight: 700; line-height: 1.5; letter-spacing: -0.18px; color: #23262f; margin: 0;">
                ChinaAMC NASDAQ 100 ETF (3086)
            </p>

            <!-- Ratio Info -->
            <div style="display: flex; flex-direction: column; gap: 8px;">
                <p
                    style="font-family: 'BLS Text', sans-serif; font-size: 16px; font-weight: 400; line-height: normal; color: #777e90; margin: 0;">
                    อัตราส่วนต่อสินทรัพย์อ้างอิง (สินทรัพย์อ้างอิง : DR)
                </p>
                <p id="calculator-ratio"
                    style="font-family: 'BLS Text', sans-serif; font-size: 16px; font-weight: 700; line-height: normal; color: #000000; margin: 0;">
                    340 : 1
                </p>
            </div>

            <!-- Input: Asset Price -->
            <div style="display: flex; flex-direction: column; gap: 8px;">
                <label
                    style="font-family: 'BLS Text', sans-serif; font-size: 16px; font-weight: 400; line-height: normal; color: #777e90;">ราคาสินทรัพย์อ้างอิง</label>
                <div
                    style="background: #fff; border: 1px solid #cbd3df; border-radius: 8px; height: 44px; display: flex; align-items: center; padding: 12px 16px; gap: 16px;">
                    <input type="number" placeholder="ราคาสินทรัพย์อ้างอิง" id="assetPrice"
                        style="flex: 1; border: none; outline: none; font-family: 'BLS Text', sans-serif; font-size: 16px; color: #23262f;">
                    <div style="width: 1px; height: 43px; background-color: #cbd3df;"></div>
                    <span style="font-family: 'BLS Text', sans-serif; font-size: 16px; color: #23262f;">HKD</span>
                </div>
            </div>

            <!-- Input: Exchange Rate -->
            <div style="display: flex; flex-direction: column; gap: 8px;">
                <label
                    style="font-family: 'BLS Text', sans-serif; font-size: 16px; font-weight: 400; line-height: normal; color: #777e90;">อัตราแลกเปลี่ยน</label>
                <div
                    style="background: #fff; border: 1px solid #cbd3df; border-radius: 8px; height: 44px; display: flex; align-items: center; padding: 12px 16px; gap: 16px;">
                    <input type="number" value="33.68" id="exchangeRate"
                        style="flex: 1; border: none; outline: none; font-family: 'BLS Text', sans-serif; font-size: 16px; color: #23262f;">
                    <div style="width: 1px; height: 43px; background-color: #cbd3df;"></div>
                    <span style="font-family: 'BLS Text', sans-serif; font-size: 16px; color: #23262f;">HKD/THB</span>
                </div>


            </div>

            <!-- See Info Button -->
            <a id="calculator-info-btn" href="#"
                style="display: flex; justify-content: center; align-items: center; width: 100%; height: 44px; border: 2px solid #1e90ff; border-radius: 8px; background: transparent; text-decoration: none; cursor: pointer;">
                <span
                    style="font-family: 'BLS', sans-serif; font-size: 16px; font-weight: 700; line-height: 1.5; color: #1e90ff;">ดูข้อมูล
                    NDX01</span>
            </a>
        </div>

        <!-- Right Panel: Result Display -->
        <div
            style="flex: 1; background: #1b3664; padding: 40px; display: flex; flex-direction: column; justify-content: space-between;">
            <div style="display: flex; flex-direction: column; gap: 32px;">
                <!-- Widget Title -->
                <div style="display: flex; flex-direction: column; gap: 16px;">
                    <h3
                        style="font-family: 'BLS', sans-serif; font-size: 28px; font-weight: 800; line-height: 1.2; color: #fff; margin: 0;">
                        ราคา DR โดยประมาณ</h3>
                    <div style="height: 1px; background: #cbd3df;"></div>
                </div>

                <!-- Fair Price Display -->
                <div style="display: flex; align-items: center; gap: 16px;">
                    <p
                        style="flex: 1; font-family: 'BLS', sans-serif; font-size: 24px; font-weight: 800; line-height: 1.2; color: #fff; margin: 0;">
                        Estimated Price (THB)</p>
                    <p id="fairPrice"
                        style="font-family: 'BLS', sans-serif; font-size: 40px; font-weight: 800; line-height: 1.2; color: #fff; margin: 0;">
                        0.00</p>
                </div>
            </div>

            <!-- Disclaimer -->
            <div style="display: flex; flex-direction: column; gap: 8px;">
                <p
                    style="font-family: 'BLS Text', sans-serif; font-size: 14px; font-weight: 400; line-height: 1.5; color: #e6e8ed; margin: 0;">
                    Disclaimer</p>
                <p
                    style="font-family: 'BLS Text', sans-serif; font-size: 14px; font-weight: 400; line-height: 1.5; color: #e6e8ed; margin: 0;">
                    ราคา DR ที่แสดงเป็นการคำนวณโดยอ้างอิงจากราคาสินทรัพย์อ้างอิง อัตราแลกเปลี่ยน
                    และอัตราส่วนต่อสินทรัพย์อ้างอิง ซึ่งเป็นเพียงการประมาณการเบื้องต้นเท่านั้น ราคาดังกล่าว
                    อาจไม่สอดคล้องกับราคาซื้อขายจริงในตลาด เนื่องจากยังมีปัจจัยที่ส่งผลต่อราคา DR เช่น
                    ความต้องการซื่อขายในตลาด (Demand & Supply) ช่วงเวลาการเปิด-ปิดของตลาดหลักทรัพย์ต่างประเทศ
                    ผู้ลงทุนควรพิจารณาข้อมูลอย่างรอบด้านก่อนตัดสินใจลงทุน
                </p>
            </div>
        </div>
    </div>

</div>
<script>
    // DR01 data
    const drData = {
        "DR01": [
            {
                "code": "NDX01",
                "issuer": "ChinaAMC NASDAQ 100 ETF",
                "underlyingIndex": "NASDAQ 100",
                "market": "US",
                "ratio": "340:1",
                "lastPrice": 20.87,
                "percentChange": "+0.25%",
                "dr1M": "+0.25%",
                "ul1M_THB": "+0.25%"
            },
            {
                "code": "SP50001",
                "issuer": "Hang Seng S&P 500 Index ETF",
                "underlyingIndex": "S&P 500",
                "market": "US",
                "ratio": "120:1",
                "lastPrice": 18.55,
                "percentChange": "-0.12%",
                "dr1M": "+1.12%",
                "ul1M_THB": "+1.25%"
            },
            {
                "code": "CN01",
                "issuer": "ChinaAMC CSI 300 Index ETF",
                "underlyingIndex": "CSI 300",
                "market": "US",
                "ratio": "95:1",
                "lastPrice": 27.40,
                "percentChange": "+0.88%",
                "dr1M": "+3.52%",
                "ul1M_THB": "+3.41%"
            },
            {
                "code": "STAR5001",
                "issuer": "Premia China STAR50 ETF",
                "underlyingIndex": "STAR50",
                "market": "US",
                "ratio": "110:1",
                "lastPrice": 22.10,
                "percentChange": "+0.33%",
                "dr1M": "+1.20%",
                "ul1M_THB": "+1.15%"
            },
            {
                "code": "CNTECH",
                "issuer": "ChinaAMC Hang Seng TECH Index ETF",
                "underlyingIndex": "Hang Seng TECH",
                "market": "US",
                "ratio": "150:1",
                "lastPrice": 14.80,
                "percentChange": "-0.05%",
                "dr1M": "+0.90%",
                "ul1M_THB": "+1.02%"
            },
            {
                "code": "HK01",
                "issuer": "Tracker Fund of Hong Kong",
                "underlyingIndex": "Hang Seng TECH",
                "market": "US",
                "ratio": "150:1",
                "lastPrice": 14.80,
                "percentChange": "-0.05%",
                "dr1M": "+0.90%",
                "ul1M_THB": "+1.02%"
            },
            {
                "code": "HKCE01",
                "issuer": "Hang Seng China Enterprises Index ETF",
                "underlyingIndex": "Hang Seng TECH",
                "market": "US",
                "ratio": "150:1",
                "lastPrice": 14.80,
                "percentChange": "-0.05%",
                "dr1M": "+0.90%",
                "ul1M_THB": "+1.02%"
            },
            {
                "code": "E1VFVN3001",
                "issuer": "DCVFMVN30 ETF",
                "underlyingIndex": "Hang Seng TECH",
                "market": "US",
                "ratio": "150:1",
                "lastPrice": 14.80,
                "percentChange": "-0.05%",
                "dr1M": "+0.90%",
                "ul1M_THB": "+1.02%"
            },
            {
                "code": "FUEVFND01",
                "issuer": "DCVFMVN DIAMOND ETF",
                "underlyingIndex": "Hang Seng TECH",
                "market": "US",
                "ratio": "150:1",
                "lastPrice": 14.80,
                "percentChange": "-0.05%",
                "dr1M": "+0.90%",
                "ul1M_THB": "+1.02%"
            },
            {
                "code": "INDIA01",
                "issuer": "ChinaAMC MSCI India ETF",
                "underlyingIndex": "Hang Seng TECH",
                "market": "US",
                "ratio": "150:1",
                "lastPrice": 14.80,
                "percentChange": "-0.05%",
                "dr1M": "+0.90%",
                "ul1M_THB": "+1.02%"
            },
            {
                "code": "JAPAN10001",
                "issuer": "Hang Seng Japan TOPIX 100 Index ETF",
                "underlyingIndex": "Hang Seng TECH",
                "market": "US",
                "ratio": "150:1",
                "lastPrice": 14.80,
                "percentChange": "-0.05%",
                "dr1M": "+0.90%",
                "ul1M_THB": "+1.02%"
            },
            {
                "code": "AAPL01",
                "issuer": "Apple Inc.",
                "underlyingIndex": "AMZN",
                "market": "US",
                "ratio": "150:1",
                "lastPrice": 14.80,
                "percentChange": "-0.05%",
                "dr1M": "+0.90%",
                "ul1M_THB": "+1.02%"
            },
            {
                "code": "AMZN01",
                "issuer": "AMAZON.COM, INC.",
                "underlyingIndex": "AMZN",
                "market": "US",
                "ratio": "150:1",
                "lastPrice": 14.80,
                "percentChange": "-0.05%",
                "dr1M": "+0.90%",
                "ul1M_THB": "+1.02%"
            },
            {
                "code": "CRM01",
                "issuer": "Salesforce Inc.",
                "underlyingIndex": "CRM",
                "market": "US",
                "ratio": "150:1",
                "lastPrice": 14.80,
                "percentChange": "-0.05%",
                "dr1M": "+0.90%",
                "ul1M_THB": "+1.02%"
            },
            {
                "code": "GOOGL01",
                "issuer": "Alphabet Inc.",
                "underlyingIndex": "GOOGL",
                "market": "US",
                "ratio": "150:1",
                "lastPrice": 14.80,
                "percentChange": "-0.05%",
                "dr1M": "+0.90%",
                "ul1M_THB": "+1.02%"
            },
            {
                "code": "ISRG01",
                "issuer": "Intuitive Surgical Inc.",
                "underlyingIndex": "ISRG",
                "market": "US",
                "ratio": "150:1",
                "lastPrice": 14.80,
                "percentChange": "-0.05%",
                "dr1M": "+0.90%",
                "ul1M_THB": "+1.02%"
            },
            {
                "code": "META01",
                "issuer": "Meta Platforms, Inc.",
                "underlyingIndex": "META",
                "market": "US",
                "ratio": "150:1",
                "lastPrice": 14.80,
                "percentChange": "-0.05%",
                "dr1M": "+0.90%",
                "ul1M_THB": "+1.02%"
            },
            {
                "code": "MICRON01",
                "issuer": "Micron Technology, Inc.",
                "underlyingIndex": "MU",
                "market": "US",
                "ratio": "150:1",
                "lastPrice": 14.80,
                "percentChange": "-0.05%",
                "dr1M": "+0.90%",
                "ul1M_THB": "+1.02%"
            },
            {
                "code": "MSFT01",
                "issuer": "MICROSOFT CORPORATION",
                "underlyingIndex": "MSFT",
                "market": "US",
                "ratio": "150:1",
                "lastPrice": 14.80,
                "percentChange": "-0.05%",
                "dr1M": "+0.90%",
                "ul1M_THB": "+1.02%"
            },
            {
                "code": "NVDA01",
                "issuer": "NVIDIA CORPORATION",
                "underlyingIndex": "NVDA",
                "market": "US",
                "ratio": "150:1",
                "lastPrice": 14.80,
                "percentChange": "-0.05%",
                "dr1M": "+0.90%",
                "ul1M_THB": "+1.02%"
            },
            {
                "code": "ORCL01",
                "issuer": "Oracle Corporation",
                "underlyingIndex": "ORCL",
                "market": "US",
                "ratio": "150:1",
                "lastPrice": 14.80,
                "percentChange": "-0.05%",
                "dr1M": "+0.90%",
                "ul1M_THB": "+1.02%"
            },
            {
                "code": "PLTR01",
                "issuer": "Palantir Technologies Inc. Class A",
                "underlyingIndex": "PLTR",
                "market": "US",
                "ratio": "150:1",
                "lastPrice": 14.80,
                "percentChange": "-0.05%",
                "dr1M": "+0.90%",
                "ul1M_THB": "+1.02%"
            },
            {
                "code": "TSLA01",
                "issuer": "Tesla, Inc.",
                "underlyingIndex": "TSLA",
                "market": "US",
                "ratio": "150:1",
                "lastPrice": 14.80,
                "percentChange": "-0.05%",
                "dr1M": "+0.90%",
                "ul1M_THB": "+1.02%"
            },
            {
                "code": "BABA01",
                "issuer": "Alibaba Group Holding Limited",
                "underlyingIndex": "BABA",
                "market": "HK",
                "ratio": "150:1",
                "lastPrice": 14.80,
                "percentChange": "-0.05%",
                "dr1M": "+0.90%",
                "ul1M_THB": "+1.02%"
            },
            {
                "code": "BIDU01",
                "issuer": "Baidu Inc.",
                "underlyingIndex": "BIDU",
                "market": "HK",
                "ratio": "150:1",
                "lastPrice": 14.80,
                "percentChange": "-0.05%",
                "dr1M": "+0.90%",
                "ul1M_THB": "+1.02%"
            },
            {
                "code": "BILIBILI01",
                "issuer": "Bilibili Inc.",
                "underlyingIndex": "BILI",
                "market": "HK",
                "ratio": "150:1",
                "lastPrice": 14.80,
                "percentChange": "-0.05%",
                "dr1M": "+0.90%",
                "ul1M_THB": "+1.02%"
            },
            {
                "code": "BYDCOM01",
                "issuer": "BYD Company Limited",
                "underlyingIndex": "BYDCOM",
                "market": "HK",
                "ratio": "150:1",
                "lastPrice": 14.80,
                "percentChange": "-0.05%",
                "dr1M": "+0.90%",
                "ul1M_THB": "+1.02%"
            },
            {
                "code": "CATL01",
                "issuer": "Contemporary Amperex Technology Co., Limited",
                "underlyingIndex": "CATL",
                "market": "HK",
                "ratio": "150:1",
                "lastPrice": 14.80,
                "percentChange": "-0.05%",
                "dr1M": "+0.90%",
                "ul1M_THB": "+1.02%"
            },
            {
                "code": "KUAISH01",
                "issuer": "Kuaishou Technology",
                "underlyingIndex": "KUAISH",
                "market": "HK",
                "ratio": "150:1",
                "lastPrice": 14.80,
                "percentChange": "-0.05%",
                "dr1M": "+0.90%",
                "ul1M_THB": "+1.02%"
            },
            {
                "code": "PINAGAN01",
                "issuer": "Ping An Insurance (Group) Company of China, Ltd.",
                "underlyingIndex": "PINAGAN",
                "market": "HK",
                "ratio": "150:1",
                "lastPrice": 14.80,
                "percentChange": "-0.05%",
                "dr1M": "+0.90%",
                "ul1M_THB": "+1.02%"
            },
            {
                "code": "SMIC01",
                "issuer": "Semiconductor Manufacturing International Corporation",
                "underlyingIndex": "SMIC",
                "market": "HK",
                "ratio": "150:1",
                "lastPrice": 14.80,
                "percentChange": "-0.05%",
                "dr1M": "+0.90%",
                "ul1M_THB": "+1.02%"
            },
            {
                "code": "TENCENT01",
                "issuer": "Tencent Holdings Ltd.",
                "underlyingIndex": "TENCENT",
                "market": "HK",
                "ratio": "150:1",
                "lastPrice": 14.80,
                "percentChange": "-0.05%",
                "dr1M": "+0.90%",
                "ul1M_THB": "+1.02%"
            },
            {
                "code": "XIAOMI01",
                "issuer": "Xiaomi Corporation",
                "underlyingIndex": "XIAOMI",
                "market": "HK",
                "ratio": "150:1",
                "lastPrice": 14.80,
                "percentChange": "-0.05%",
                "dr1M": "+0.90%",
                "ul1M_THB": "+1.02%"
            },
            {
                "code": "ASML01",
                "issuer": "ASML Holding N.V.",
                "underlyingIndex": "ASML",
                "market": "NL",
                "ratio": "150:1",
                "lastPrice": 14.80,
                "percentChange": "-0.05%",
                "dr1M": "+0.90%",
                "ul1M_THB": "+1.02%"
            },
            {
                "code": "LVMH01",
                "issuer": "LVMH Moët Hennessy Louis Vuitton SE",
                "underlyingIndex": "LVMH",
                "market": "FR",
                "ratio": "150:1",
                "lastPrice": 14.80,
                "percentChange": "-0.05%",
                "dr1M": "+0.90%",
                "ul1M_THB": "+1.02%"
            },
        ]
    };

    // Initialize
    let currentDR = drData.DR01[0];
    let currentRatio = 1 / parseInt(currentDR.ratio.split(':')[0], 10);

    const drInput = document.getElementById('calculator-dr-code');
    const dropdownList = document.getElementById('dropdownList');
    const searchIcon = document.querySelector('.calculator-search-icon');
    const assetPriceInput = document.getElementById('assetPrice');
    const exchangeRateInput = document.getElementById('exchangeRate');
    const fairPriceDisplay = document.getElementById('fairPrice');


    let isDropdownOpen = false;



    // Update calculator display
    function updateCalculatorDisplay(dr) {
        drInput.value = dr.code;
        document.getElementById('calculator-etf-name').textContent = dr.issuer;
        document.getElementById('calculator-ratio').textContent = dr.ratio;


        const ratioParts = dr.ratio.split(':');
        currentRatio = 1 / parseInt(ratioParts[0], 10);

        // Update button text
        const infoBtnSpan = document.querySelector('#calculator-info-btn span');
        if (infoBtnSpan) {
            infoBtnSpan.textContent = 'ดูข้อมูล ' + dr.code;
        }

        calculateFairPrice();
    }

    // Calculate fair price
    function calculateFairPrice() {
        const assetPrice = parseFloat(assetPriceInput.value) || 0;
        const exchangeRate = parseFloat(exchangeRateInput.value) || 33.68;
        const fairPrice = (assetPrice * exchangeRate) * currentRatio;
        fairPriceDisplay.textContent = fairPrice.toFixed(2);
    }

    // Search icon click
    searchIcon.addEventListener('click', function (e) {
        e.stopPropagation();

        // Clear input and open dropdown with all items
        drInput.value = '';
        drInput.focus();
        filterDropdownItems('');

        // Show dropdown
        isDropdownOpen = true;
        dropdownList.style.display = 'block';
    });

    // Input change
    drInput.addEventListener('input', function () {
        const searchTerm = this.value.trim();
        if (searchTerm.length > 0) {
            filterDropdownItems(searchTerm);
            dropdownList.style.display = 'block';
            isDropdownOpen = true;
        } else {
            dropdownList.style.display = 'none';
            isDropdownOpen = false;
        }
    });

    // Click outside to close
    document.addEventListener('click', function (e) {
        if (!e.target.closest('#calculator-dr-code') && !e.target.closest('.calculator-search-icon') && !e.target.closest('#dropdownList')) {
            dropdownList.style.display = 'none';
            isDropdownOpen = false;
        }
    });

    // Filter dropdown items
    function filterDropdownItems(searchTerm) {
        const filtered = drData.DR01.filter(dr => {
            const searchLower = searchTerm.toLowerCase();
            return dr.code.toLowerCase().includes(searchLower);
        });

        renderDropdownItems(filtered);
    }

    // Render dropdown items
    function renderDropdownItems(items) {
        dropdownList.innerHTML = '';

        if (items.length === 0) {
            dropdownList.innerHTML = '<li style="padding: 20px; text-align: center; color: #777e90;">ไม่พบข้อมูล</li>';
            return;
        }

        items.forEach(dr => {
            const li = document.createElement('li');
            li.style.cssText = 'padding: 12px 16px; cursor: pointer; border-bottom: 1px solid #f1f4f8;';
            li.innerHTML = `
                <div style="font-family: 'BLS', sans-serif; font-size: 14px; font-weight: 700; color: #000000;">${dr.code}</div>
            `;

            li.addEventListener('mouseenter', function () {
                this.style.backgroundColor = '#f1f4f8';
            });
            li.addEventListener('mouseleave', function () {
                this.style.backgroundColor = '';
            });

            li.addEventListener('click', function () {
                currentDR = dr;
                updateCalculatorDisplay(dr);
                dropdownList.style.display = 'none';
                isDropdownOpen = false;
            });

            dropdownList.appendChild(li);
        });
    }

    // Event listeners for calculation
    assetPriceInput.addEventListener('input', calculateFairPrice);
    exchangeRateInput.addEventListener('input', calculateFairPrice);



    // Initialize display
    updateCalculatorDisplay(currentDR);
</script>